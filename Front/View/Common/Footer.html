<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript">
    //jQuery.noConflict();
    $(document).ready(function(){
        //wx_share();
    });

    function wx_share(text,img,id){
        if (!!text) {
            var tl_title = '';
            var app_title = '';
            var app_desc = '';
        } else {
            var tl_title = '测试分享语';
            var app_title = '测试标题';
            var app_desc = '测试内容';
        }

        if (!!img) {
            var http_image = '';
        } else {
            var http_image = "<?php echo $assets_server; ?>Common/Images/fx.jpg";
        }

        if (!!id) {
            var http = "";
        } else {
            var http = "<?php echo $http_server; ?>";
        }

        st.get('<?php echo $http_server; ?>route=Front/Common/Common/wx_share',{signature_url:location.href.split('#')[0]},function(data){
            if (data.status == -1) {
                alert(data.result);
            } else {
                st.wxshare(data.result, ['onMenuShareTimeline', 'onMenuShareAppMessage', 'chooseImage', 'previewImage', 'uploadImage', 'downloadImage']);
                wx_ready();
            }
        });

        function wx_ready() {
            wx.ready(function () {
                wx.onMenuShareTimeline({
                    title: tl_title, // 分享标题
                    link: http, // 分享链接
                    imgUrl: http_image, // 分享图标
                    success: function () {
                        // 用户确认分享后执行的回调函数
                    },
                    cancel: function () {
                        // 用户取消分享后执行的回调函数
                    }
                });

                wx.onMenuShareAppMessage({
                    title: app_title, // 分享标题
                    desc: app_desc, // 分享描述
                    link: http, // 分享链接
                    imgUrl: http_image, // 分享图标
                    type: '', // 分享类型,music、video或link，不填默认为link
                    dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                    success: function () {
                        // 用户确认分享后执行的回调函数
                    },
                    cancel: function () {
                        // 用户取消分享后执行的回调函数
                    }
                });
            });
        }
    }
</script>
</body>
</html>